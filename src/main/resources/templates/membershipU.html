<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">

<head>
    <meta charset="UTF-8">
    <title>WaterMelon</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.css" />
    <!-- common.css    -->
    <link rel="stylesheet" type="text/css" href="/css/common.css">
    <link rel="stylesheet" type="text/css" href="/css/header.css">
    <link rel="stylesheet" type="text/css" href="/css/membershipU.css">
    <link rel="stylesheet" type="text/css" href="/css/footer.css">

    <!-- favicon.ico   -->
    <link rel="icon" href="/images/favicon/favicon.ico" />

</head>

<body>
<div class="wrapper">
    <!-- 메인 -->
    <header>
        <div class="top-header">
            <a href="/main" ><img class="logo" src="/images/로고.png" alt=""></a>
            <form action="/search" method="get">
                <div class="search_box">
                    <select name="type"  class="selectbox" >
                        <option value="title" selected>TITLE</option>
                        <option value="artist">ARTIST</option>
                    </select>
                    <input id="searchInput" type="text" name="searchText" placeholder="듣고 싶은 노래를 검색하세요!" >
                    <button type="submit">🔍</button>
                </div>
            </form>
            <ul>
                <li><a href="/membership"
                       style="color:rgb(92, 115, 6); font-family: 'SDSamliphopangche_Basic'; font-size: 19px;"><img
                        src="/images/add.png" alt=""> 멤버십가입</a></li>
                <li><a href=""><img src="/images/english.png" alt="">ENGLISH</a></li>
            </ul>
        </div>
    </header>
    <nav>
        <div class="mobilemenu">
                <span href="" class="material-symbols-outlined">menu
                    <ul class="wa">
                        <li><a href="">수박차트</a></li>
                        <li><a href="">수박DJ</a></li>
                        <li><a href="">수박TV</a></li>
                        <li><a href="">수박매거진</a></li>
                        <li><a href="">공지사항</a></li>
                        <li><a href="">마이페이지</a></li>
                    </ul>
                </span>
        </div>
        <div class="navi">
            <div class="Menu_left">
                <ul class="one--depth">
                    <li>
                        <a href="">수박차트</a>
                        <ul class="two--depth">
                            <li><a href="/Top100">TOP100</a></li>
                            <li><a href="">최신음악</a></li>
                            <li><a href="">장르음악</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="">수박DJ</a>
                        <ul class="two--depth">
                            <li><a href="">#투데이</a></li>
                            <li><a href="">테마장르</a></li>
                            <li><a href="">인기선곡</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="">수박TV</a>
                        <ul class="two--depth">
                            <li><a href="">뮤직비디오</a></li>
                            <li><a href="">수박방송</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="">수박매거진</a>
                        <ul class="two--depth">
                            <li><a href="">오늘의매거진</a></li>
                            <li><a href="">완결매거진</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
            <div class="Menu_right">
                <ul class="one--depth">
                    <li>
                        <a href="">공지사항</a>
                        <ul class="two--depth">
                            <li><a href="/notice/list">공지사항</a></li>
                            <li><a href="/qna/list">QnA</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="">마이페이지</a>
                        <ul class="two--depth">
                            <li><a href="/member/mypage" />정보수정</a></li>
                            <li><a href="/inmylist">마이리스트</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>

    </nav>
    <div class="header_line"></div>
    <section class="ms_pay">
        <span class="title">멤버십 가입</span>
        <div class="myMembership" th:if="${myMembership!=null }">
            <span th:text="|~ ${myMembership.enddate}|" style="font-size:20px; color:gray;"></span><br/>
            <span th:text="${myMembership.membershipcode}" style="font-size:27px; color: rgb(192, 57, 43);"></span>을 구독중입니다!
            <!--<a class="term_btn" th:data-username="${myMembership.username}" type="button">해지</a>-->
            <a class="term_btn" th:data-username="${myMembership.username}" onclick="terminateMembership()" type="button">해지</a>
        </div>
        <div>
            <div class="subscribe_1" >
                <span style="font-size:27px; color:rgb(92, 115, 6);">첫 구독 1개월 무료!</span>
                <span style="color: rgb(192, 57, 43);"> WMM_1</span>
                <span>무제한 스트리밍</span>
                <span class="price">월 6,900원</span>
                <img class="sub_img" src="/images/subscribe.png" alt="">
            </div>
            <div class="subscribe_2">
                <span style="color: rgb(192, 57, 43);"> WMM_2</span>
                <span>무제한 스트리밍</span>
                <span>오프라인 듣기</span>
                <span class="price">월 9,900원</span>
                <img class="sub_img" src="/images/subscribe.png" alt="">
            </div>
        </div>

    </section>
    <section class="ms_benefit">
        <span class="title">멤버십의 특별한 혜택!</span>
        <div id="ben_img">
            <div class="benefit_icon"><img src="/images/crew.png" alt=""></div>
            <div class="benefit_icon"><img src="/images/welcom_kit.png" alt=""></div>
            <div class="benefit_icon"><img src="/images/birthday.png" alt=""></div>
            <div class="benefit_icon"><img src="/images/movie_ticket.png" alt=""></div>
        </div>
        <span id="title1">WATERMELON CREW</span>
        <span id="title2">BIRTHDAY COUPON</span>
        <span id="title3">WELCOME KIT</span>
        <span id="title4">MOVIE TICKET</span>
    </section>
    <footer>
        <div class="footer_line"></div>
        <div>
            <ul class="footer_menu">
                <li><a href="">이용약관</a></li>
                <li><a href="">고객센터</a></li>
                <li><a href="">제휴/프로모션</a></li>
                <li style="width:170px"><a href=""> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;개인정보처리방침</a></li>
            </ul>
        </div>
        <p></p>
        <div class="Site_info">
            <img id="footer_logo" src="/images/로고.png" alt="">
            <span class="Sitename">(주)WATERMELON MUSIC</span>
            <span>대구광역시 중구 중앙대로 366 반월센트럴타워 10층</span>
            <span>대표이사 : 윤치연, 김예솔, 이헌지, 최정기</span>
            <span>사업자등록번호 : 024-04-02023</span>
            <br>
            <span>문의전화 : 1544-1111 (평일 09:00-18:00)</span>
            <span>WATERMELON MUSIC으로 음악과 함께하는 즐거운 하루 보내세요!</span>
        </div>

    </footer>
</div>
</body>

<!-- axios cdn -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.5.0/axios.min.js" integrity="sha512-aoTNnqZcT8B4AmeCFmiSnDlc4Nj/KPaZyB5G7JnOnUEkdNpCZs1LCankiYi01sLTyWy+m2P+W4XM+BuQ3Q4/Dg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script th:inline="javascript">
    //model변수 받아오기
    var enddate = [[${enddate}]];
</script>

<script>
    const subscribe1_el = document.querySelector('.subscribe_1');
subscribe1_el.addEventListener('click', function () {
    axios.get('/membership/request1')
    .then(response=>{
        console.log("request1 Success");
        console.log(response);
        console.log(response.data);
        console.log(response.data.next_redirect_pc_url);
        window.open(response.data.next_redirect_pc_url, "Payment","width=400,height=700");
    })
    .catch(error=>{});
});


const subscribe2_el = document.querySelector('.subscribe_2');
subscribe2_el.addEventListener('click', function () {
    axios.get('/membership/request2')
    .then(response=>{
        console.log("request2 Success");
        console.log(response);
        console.log(response.data);
        console.log(response.data.next_redirect_pc_url);
        window.open(response.data.next_redirect_pc_url, "Payment","width=400,height=700");
    })
    .catch(error=>{});
});


    function terminateMembership() {
    const term_btn_el = document.querySelector('.term_btn');
    const username = term_btn_el.dataset.username;
    // 사용자에게 확인 메시지를 표시
    if (confirm("정말 구독을 취소하시겠습니까?") == true){
        axios.delete("/membership/terminate?username=" + username)
        .then(response=>{
            if(response.status === 200){
                console.log(username+"님 구독취소 완료!");
                alert(username+"님 구독이 취소되었습니다! "+enddate+"까지 구독이 유지됩니다.")
                location.reload();
            }
        })
        .catch(error=>{console.log(error)});
    }else{
        console.log("구독 해지를 취소하였습니다.");
        alert("구독 해지가 취소되었습니다!");
    }
}
</script>


</html>